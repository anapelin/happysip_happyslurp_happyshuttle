coordinates <- cbind(nightlife_ft$venue_lon, nightlife_ft$venue_lat)
# Convert the dataframe to a SpatialPointsDataFrame
nightlife_ft_sp <- SpatialPointsDataFrame(coordinates, data = data.frame(nightlife_ft), proj4string = CRS("+proj=longlat +datum=WGS84"))
# convert to sf
nightlife_ft_sf <- st_as_sf(nightlife_ft_sp)
nightlife_ft_sf <- st_transform(nightlife_ft_sf, crs=st_crs(subzones))
restaurants_ft_sf <- restaurants_sf
hours_to_select <- c(1, 2, 3, 22, 23, 24)
for (i in 1:6) {
new_fri_ft <- paste0("ft_fri_hour", hours_to_select[i])
nightlife_ft_sf[[new_fri_ft]] <- sapply(nightlife_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_fri_ft]] <- sapply(restaurants_ft_sf$fri_cd, function(x) {
tryCatch({
list_values <- fromJSON(x)
if (length(list_values) >= indices_to_select[i]) {
return(list_values[indices_to_select[i]])
} else {
return(NA)
}
}, error = function(e) {
return(NA)
})
})
new_sat_ft <- paste0("ft_sat_hour", hours_to_select[i])
nightlife_ft_sf[[new_sat_ft]] <- sapply(nightlife_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_sat_ft]] <- sapply(restaurants_ft_sf$sat_cd, function(x) {
tryCatch({
list_values <- fromJSON(x)
if (length(list_values) >= indices_to_select[i]) {
return(list_values[indices_to_select[i]])
} else {
return(NA)
}
}, error = function(e) {
return(NA)
})
})
}
View(nightlife_ft_sf)
View(restaurants_ft_sf)
restaurants_sf[1]
restaurants_ft_sf$fri_cd
View(restaurants_sf)
nightlife_ft_sf$sat_cd[1]
nightlife_ft_sf <- st_as_sf(nightlife_ft_sp)
nightlife_ft_sf <- st_transform(nightlife_ft_sf, crs=st_crs(subzones))
restaurants_ft_sf <- restaurants_sf
hours_to_select <- c(17, 18, 19, 20, 21)
for (i in 1:6) {
new_fri_ft <- paste0("ft_fri_hour", hours_to_select[i])
nightlife_ft_sf[[new_fri_ft]] <- sapply(nightlife_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_fri_ft]] <- sapply(restaurants_ft_sf$fri_cd, function(x) {
tryCatch({
list_values <- fromJSON(x)
if (length(list_values) >= indices_to_select[i]) {
return(list_values[indices_to_select[i]])
} else {
return(NA)
}
}, error = function(e) {
return(NA)
})
})
new_sat_ft <- paste0("ft_sat_hour", hours_to_select[i])
nightlife_ft_sf[[new_sat_ft]] <- sapply(nightlife_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_sat_ft]] <- sapply(restaurants_ft_sf$sat_cd, function(x) {
tryCatch({
list_values <- fromJSON(x)
if (length(list_values) >= indices_to_select[i]) {
return(list_values[indices_to_select[i]])
} else {
return(NA)
}
}, error = function(e) {
return(NA)
})
})
}
View(nightlife_ft_sf)
View(restaurants_ft_sf)
list_values <- fromJSON(nightlife_ft_sf$fri_cd[1])
class(nightlife_ft_sf$fri_cd[1])
print(nightlife_ft_sf$fri_cd[1])
hours_to_select <- c(17, 18, 19, 20, 21)
for (i in 1:5) {
new_fri_ft <- paste0("ft_fri_hour", hours_to_select[i])
nightlife_ft_sf[[new_fri_ft]] <- sapply(nightlife_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_fri_ft]] <- sapply(restaurants_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
new_sat_ft <- paste0("ft_sat_hour", hours_to_select[i])
nightlife_ft_sf[[new_sat_ft]] <- sapply(nightlife_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_sat_ft]] <- sapply(restaurants_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
}
View(restaurants_ft_sf)
for (i in 1:5) {
new_fri_ft <- paste0("ft_fri_hour", hours_to_select[i])
nightlife_ft_sf[[new_fri_ft]] <- sapply(nightlife_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_fri_ft]] <- sapply(restaurants_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
new_sat_ft <- paste0("ft_sat_hour", hours_to_select[i])
nightlife_ft_sf[[new_sat_ft]] <- sapply(nightlife_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_sat_ft]] <- sapply(restaurants_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
}
View(restaurants_ft_sf)
nightlife_ft_sf <- st_as_sf(nightlife_ft_sp)
nightlife_ft_sf <- st_transform(nightlife_ft_sf, crs=st_crs(subzones))
restaurants_ft_sf <- restaurants_sf
hours_to_select <- c(17, 18, 19, 20, 21)
for (i in 1:5) {
new_fri_ft <- paste0("ft_fri_hour", hours_to_select[i])
nightlife_ft_sf[[new_fri_ft]] <- sapply(nightlife_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_fri_ft]] <- sapply(restaurants_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
new_sat_ft <- paste0("ft_sat_hour", hours_to_select[i])
nightlife_ft_sf[[new_sat_ft]] <- sapply(nightlife_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_sat_ft]] <- sapply(restaurants_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
}
View(nightlife_ft_sf)
View(restaurants_ft_sf)
nightlife_ft_sf$sat_cd[1]
restaurants_ft_sf$sat_cd[1]
View(restaurants_ft_sf)
restaurants_ft_sf$sat_cd[8]
class(restaurants_ft_sf$sat_cd[8])
for (i in 1:5) {
new_fri_ft <- paste0("ft_fri_hour", hours_to_select[i])
nightlife_ft_sf[[new_fri_ft]] <- sapply(nightlife_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_fri_ft]] <- sapply(restaurants_ft_sf$fri_cd, function(x) fromJSON(x)[hours_to_select[i]])
new_sat_ft <- paste0("ft_sat_hour", hours_to_select[i])
nightlife_ft_sf[[new_sat_ft]] <- sapply(nightlife_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_sat_ft]] <- sapply(restaurants_ft_sf$sat_cd, function(x) fromJSON(x)[hours_to_select[i]])
}
fromJSON(restaurants_ft_sf$sat_cd[8])
fromJSON(restaurants_ft_sf$sat_cd[1])
restaurants_ft_sf$sat_cd[1]
hours_to_select <- c(17, 18, 19, 20, 21)
for (i in 1:5) {
new_fri_ft <- paste0("ft_fri_hour", hours_to_select[i])
nightlife_ft_sf[[new_fri_ft]] <- sapply(nightlife_ft_sf$fri_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_fri_ft]] <- sapply(restaurants_ft_sf$fri_cd, function(x) {
if (x == "") {return(NA)}
else {fromJSON(x)[hours_to_select[i]]}})
new_sat_ft <- paste0("ft_sat_hour", hours_to_select[i])
nightlife_ft_sf[[new_sat_ft]] <- sapply(nightlife_ft_sf$sat_cd, function(x) x[hours_to_select[i]])
restaurants_ft_sf[[new_sat_ft]] <- sapply(restaurants_ft_sf$sat_cd, function(x) {
if (x == "") {return(NA)}
else {fromJSON(x)[hours_to_select[i]]}})
}
View(restaurants_ft_sf)
View(nightlife_ft_sf)
foottraffic_sf <- select(nightlife_ft_sf, -c(venue_lat, venue_lon, fri_cd, sat_cd))
View(foottraffic_sf)
foottraffic_sf <- nightlife_ft_sf %>% select(-c(venue_lat, venue_lon, fri_cd, sat_cd)) %>% rename("name" = "venue_name") %>% mutate(type = "nightlife")
View(foottraffic_sf)
hist(nn.sim,breaks=30, xlim=c(0,300))
nn.sim = vector()
P.r = P
for(i in 1:999){
marks(P.r) = sample(P$marks)  # Reassign labels at random, point locations don't change
nn.sim[i] = mean(nncross(P.r[P.r$marks == "nightlife", ] ,P.r[P.r$marks == "latenight restaurants", ])$dist)
}
hist(nn.sim,breaks=30, xlim=c(0,300))
P <- superimpose(nightlife_ppp, latenight_restaurants_ppp)
nn.sim = vector()
P.r = P
for(i in 1:999){
marks(P.r) = sample(P$marks)  # Reassign labels at random, point locations don't change
nn.sim[i] = mean(nncross(P.r[P.r$marks == "nightlife", ] ,P.r[P.r$marks == "latenight restaurants", ])$dist)
}
hist(nn.sim,breaks=30, xlim=c(0,300))
abline(v=mean(nncross(nightlife_ppp,restaurants_ppp)$dist),col="red")
P <- superimpose(nightlife_ppp, latenight_restaurants_ppp)
# hypothesis testing for the distribution of nightlife and latenight restaurants
nn.sim = vector()
P.r = P
for(i in 1:999){
marks(P.r) = sample(P$marks)  # Reassign labels at random, point locations don't change
nn.sim[i] = mean(nncross(P.r[P.r$marks == "nightlife", ] ,P.r[P.r$marks == "latenight restaurants", ])$dist)
}
hist(nn.sim,breaks=30, xlim=c(0,300))
abline(v=mean(nncross(nightlife_ppp,latenight_restaurants_ppp)$dist),col="red")
nn.sim = vector()
P.r = P
for(i in 1:999){
marks(P.r) = sample(P$marks)  # Reassign labels at random, point locations don't change
nn.sim[i] = mean(nncross(P.r[P.r$marks == "nightlife", ] ,P.r[P.r$marks == "latenight restaurants", ])$dist)
}
hist(nn.sim,breaks=30, xlim=c(0,300), main="Histogram of nearest neighbour distance between nightlife and late night restaurants under CRS")
abline(v=mean(nncross(nightlife_ppp,latenight_restaurants_ppp)$dist),col="red")
nn.sim = vector()
P.r = P
for(i in 1:999){
marks(P.r) = sample(P$marks)  # Reassign labels at random, point locations don't change
nn.sim[i] = mean(nncross(P.r[P.r$marks == "nightlife", ] ,P.r[P.r$marks == "latenight restaurants", ])$dist)
}
hist(nn.sim,breaks=30, xlim=c(0,300), main="Histogram of nearest neighbour distance")
abline(v=mean(nncross(nightlife_ppp,latenight_restaurants_ppp)$dist),col="red")
tmap_mode('view')
tm_shape(base_map) + tm_borders(col='black') +
tm_shape(nightlife_density_subzone) + tm_polygons(col = "nightlife_density") +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife location in Singapore",
title.position = c('left', 'bottom'))
# KDE - use nightlife_ppp here
Local Density - By Subzone
# Local Density - By Subzone
tm_shape(base_map) + tm_borders(col='black') +
tm_shape(nightlife_density_subzone) + tm_polygons(col = "nightlife_density") +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife density in Singapore",
title.position = c('left', 'bottom'))
View(hdb)
hdb_sf <- st_as_sf(yth_data, coords = c("lat", "lon"), crs = 4326)
View(hdb_sf)
View(hdb)
# 3.4 HDB
hdb_sf <- st_as_sf(yth_data, coords = c("lat", "lng"), crs = 4326)
# 3.4 HDB
hdb_sf <- st_as_sf(hdb, coords = c("lat", "lng"), crs = 4326)
hdb_sf <- st_transform(hdb_sf, crs = st_crs(subzones)) # project to basemap's
tm_shape(base_map) + tm_borders(col='black') +
tm_shape(hdb_sf) + tm_dots(size = 0.0075, col = "red") + # Nightlife locations
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="HDBs location in Singapore",
title.position = c('left', 'bottom'))
tmap_mode('view')
tm_shape(base_map) + tm_borders(col='black') +
tm_shape(hdb_sf) + tm_dots(size = 0.0075, col = "red") + # Nightlife locations
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="HDBs location in Singapore",
title.position = c('left', 'bottom'))
# Local Density - Quadrat
View(hdb_sf)
coordinates <- cbind(hdb$lng, hdb$lat)
hdb_sp_data <- SpatialPointsDataFrame(coordinates, data = data.frame(hdb), proj4string = CRS("+proj=longlat +datum=WGS84"))
hdb_sf <- st_as_sf(hdb_sp_data)
hdb_sf <- st_transform(hdb_sf, crs = st_crs(subzones)) # project to basemap's
tm_shape(base_map) + tm_borders(col='black') +
tm_shape(hdb_sf) + tm_dots(size = 0.0075, col = "red") + # Nightlife locations
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="HDBs location in Singapore",
title.position = c('left', 'bottom'))
tm_shape(base_map) + tm_borders(col='black') +
tm_shape(hdb_sf) + tm_dots(size = 0.0075, col = "black") + # Nightlife locations
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="HDBs location in Singapore",
title.position = c('left', 'bottom'))
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(nightlife_filtered_sf) + tm_dots(col = "red") +
tm_shape(midnight_restaurant_filtered_sf) + tm_dots(col = "blue") +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife location in Singapore",
title.position = c('left', 'bottom'))
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(nightlife_filtered_sf) + tm_dots(col = "red") +
tm_shape(midnight_restaurant_filtered_sf) + tm_dots(col = "blue") +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
?st_union
combined = st_union(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(combined) + tm_dots(col = "label") +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined = st_union(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(combined) + tm_dots(col = "label") +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
View(combined)
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined = st_union(nightlife_filtered_sf, midnight_restaurant_filtered_sf, by_feature=TRUE)
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(combined) + tm_dots(col = "label") +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined = rbind(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined = rbind(nightlife_filtered_sf$label, midnight_restaurant_filtered_sf$label)
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(combined) + tm_dots(col = "label") +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
ightlife_filtered_sf$label = 'nightlife'
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined = rbind(nightlife_filtered_sf[label, geometry], midnight_restaurant_filtered_sf[label, geometry])
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined <- st_collect(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined <- st_union(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(combined) + tm_dots(col = c("label", "label1")) +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined <- st_union(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(combined) + tm_dots(col = c("label")) +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined <- st_combine(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
nightlife_filtered_sf <- st_combine(midnight_restaurant_filtered_sf)
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(nightlife_filtered_sf) + tm_dots(col = c("label")) +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
combined <- st_union(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(combined) + tm_dots(col = c("label")) +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
?st_join
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined <- st_join(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
ightlife_filtered_sf$label = 'nightlife'
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined <- st_union(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
nightlife_filtered_sf$label = 'nightlife'
midnight_restaurant_filtered_sf$label = 'late night restaurants'
combined <- rbind(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
nightlife_filtered_sf$label = 'nightlife'
nightlife_filtered_sf <- nightlife_filtered_sf %>% select(label, geometry)
nightlife_filtered_sf$label = 'nightlife'
nightlife_filtered_sf <- nightlife_filtered_sf %>% dplyr::select(label, geometry)
?subset
subset(nightlife_filtered_sf, select=c(geometry, label))
nightlife_filtered_sf$label = 'nightlife'
subset(nightlife_filtered_sf, select=c(geometry, label))
nightlife_filtered_sf$label = 'nightlife'
nightlife_filtered_sf <- nightlife_filtered_sf %>%
select(geometry, label)
nightlife_filtered_sf$label = 'nightlife'
nightlife_filtered_sf <- nightlife_filtered_sf %>%
select(label)
nightlife_filtered_sf
View(nightlife_filtered_sf)
nightlife_filtered_sf <- st_intersection(nightlife_sf, central_plg)
restaurant_filtered_sf <- st_intersection(restaurants_sf, central_plg)
midnight_restaurant_filtered_sf <- restaurant_filtered_sf %>% filter(midnight_restaurant == 'True')
nightlife_filtered_sf[[1]]$label = 'nightlife'
nightlife_sf
nightlife_filtered_sf[[1]]$label = 'nightlife'
nightlife_filtered_sf[[1]]$label = 'nightlife'
nightlife_labeled_sf <- nightlife_filtered_sf[[1]] %>%
select(label, geometry)
nightlife_filtered_sf[[1]]$label = 'nightlife'
View(nightlife_filtered_sf)
nightlife_filtered_sf$label = 'nightlife'
View(nightlife_filtered_sf)
nightlife_filtered_sf <- nightlife_filtered_sf %>% select(label)
View(nightlife_filtered_sf)
midnight_restaurant_filtered_sf$label = 'late night restaurants'
midnight_restaurant_filtered_sf <- midnight_restaurant_filtered_sf %>% select(label)
combined <- rbind(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
tm_shape(central_plg) + tm_borders(col='black') +
tm_shape(combined) + tm_dots(col = c("label")) +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
tm_shape(combined) + tm_dots(col = c("label")) +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
nightlife_filtered_sf$label = 'nightlife locations'
nightlife_filtered_sf <- nightlife_filtered_sf %>% select(label)
midnight_restaurant_filtered_sf$label = 'late night restaurants'
midnight_restaurant_filtered_sf <- midnight_restaurant_filtered_sf %>% select(label)
combined <- rbind(nightlife_filtered_sf, midnight_restaurant_filtered_sf)
tm_shape(combined) + tm_dots(col = c("label")) +
tm_scale_bar(width = 0.15) +
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife locations and late night restaurants in Central Singapore",
title.position = c('left', 'bottom'))
nightlife_ppp <- as.ppp(nightlife_filtered_sf)
marks(nightlife_ppp) <- "nightlife"
nightlife_ppp$n
restaurants_ppp <- as.ppp(restaurant_filtered_sf)
marks(restaurants_ppp) <- "restaurants"
latenight_restaurants_ppp <- as.ppp(midnight_restaurant_filtered_sf)
marks(latenight_restaurants_ppp) <- "latenight restaurants"
latenight_restaurants_ppp$n
restaurants_ppp$n
P <- superimpose(nightlife_ppp, latenight_restaurants_ppp)
# hypothesis testing for the distribution of nightlife and latenight restaurants
nn.sim = vector()
P.r = P
for(i in 1:999){
marks(P.r) = sample(P$marks)  # Reassign labels at random, point locations don't change
nn.sim[i] = mean(nncross(P.r[P.r$marks == "nightlife", ] ,P.r[P.r$marks == "latenight restaurants", ])$dist)
}
hist(nn.sim,breaks=30, xlim=c(0,300), main="Histogram of nearest neighbour distance")
abline(v=mean(nncross(nightlife_ppp,latenight_restaurants_ppp)$dist),col="red")
nncross(restaurants_ppp,nightlife_ppp,k=1:3)
PPM1 <- ppm(nightlife_ppp ~ latenight_restaurants_ppp)
PPM1 <- ppm(P)
?ppm
PPM1 <- ppm(P ~ marks)
PPM1 <- ppm(P ~ marks)
View(P)
P$markformat = 'factor'
P <- P$markformat = 'factor'
P$markformat = 'factor'
PPM1 <- ppm(P ~ marks)
marks(P)
marks(P) <- factor(marks(P))
PPM1 <- ppm(P ~ marks)
PPM1
PPM0 <- ppm(latenight_restaurants_ppp, 1)
PPM0 <- ppm(latenight_restaurants_ppp ~ 1)
marks(latenight_restaurants_ppp) <- factor(marks(latenight_restaurants_ppp))
PPM0 <- ppm(latenight_restaurants_ppp ~ 1)
PPM0
anova(PPM0, PPM1, test="LRT")
PPM0 <- ppm(P ~ 1)
anova(PPM0, PPM1, test="LRT")
marks(nightlife_ppp) <- factor(marks(nightlife_ppp))
PPM1 <- ppm(latenight_restaurants_ppp ~ nightlife_ppp)
