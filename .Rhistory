tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
r <- raster(dat.krg)
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
crs(bcr)
crs(grd)
crs(bcr) <- crs(base_spatial)
crs(base_spatial)
crs(grd) <- crs(bcr)
bcr@bbox <- base_spatial@bbox
base_map
subzones <- st_read(dsn = "dataset/basemap", layer = "MP14_SUBZONE_NO_SEA_PL")
#Central area of SG
base_map <- st_read(dsn = "dataset/basemap", layer = "MP14_SUBZONE_NO_SEA_PL")
central_area <- base_map %>% filter(PLN_AREA_N %in% c('DOWNTOWN CORE', 'BUKIT MERAH', 'SINGAPORE RIVER', 'MUSEUM', 'RIVER VALLEY', 'ORCHARD','NEWTON','ROCHOR','TANGLIN', 'KALLANG','OUTRAM')) %>% filter(!SUBZONE_N %in% c( 'CITY TERMINALS','MARITIME SQUARE','ALEXANDRA HILL','TELOK BLANGAH DRIVE','DEPOT ROAD','TELOK BLANGAH WAY','TELOK BLANGAH RISE'))
base_map <- st_transform(central_area, crs=st_crs(central_area))
#Bars and Clubs dataframe
bcr <- read_csv('dataset/besttime/processed_bars_clubs.csv')
bcr <- na.omit(bcr)
#Restaurants dataframe
res <- read_csv('dataset/besttime/processed_restaurants.csv')
res <- na.omit(res)
res <- res %>% rename(`12am_cd` = `12pm_cd`)
bcr <- bcr %>% select(lat,lon, `10pm_cd`,`11pm_cd`,`12am_cd`,`1am_cd`,`2am_cd`) %>% mutate(cat = "Bars and Clubs")
res <- res %>% select(lat,lon, `10pm_cd`,`11pm_cd`,`12am_cd`,`1am_cd`,`2am_cd`)%>% mutate(cat = "Restaurants")
bcr <- rbind(bcr,res)
bcr$`cd_10` <- bcr$`10pm_cd`
bcr$`cd_11` <- bcr$`11pm_cd`
bcr$`cd_12` <- bcr$`12am_cd`
bcr$`cd_1` <- bcr$`1am_cd`
bcr$`cd_2` <- bcr$`2am_cd`
coordinates(bcr) <- ~lon + lat
#Tranform to spatial dataframe and see how it looks like
plot(bcr) #notice that one point is so much further away than the rest
bcr <- bcr[-c(10,49),] #Remove that one point for better interpolation
plot(bcr) #Corrected plot without annoying point
bcr$X <- coordinates(bcr)[,1]
bcr$Y <- coordinates(bcr)[,2]
bcr <- bcr[-zerodist(bcr)[,1],]
base_spatial <- as(base_map, 'Spatial')
bcr_spatial <- st_as_sf(bcr, coords = c("lon", "lat"))
tmap_mode('plot')
tmap_options(check.and.fix = TRUE)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(bcr_spatial) + tm_dots(size = 0.5, col = "red") + # Nightlife and Restaurants locations
tm_scale_bar(width = 0.15)
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife and Late Restaurants \n in Singapore",
title.position = c('left', 'bottom'))
#Making the raster grid
grd              <- as.data.frame(spsample(bcr, "regular", n=50000))
names(grd)       <- c("X", "Y")
coordinates(grd) <- c("X", "Y")
gridded(grd)     <- TRUE
fullgrid(grd)    <- TRUE
crs(bcr) <- crs(base_spatial)
crs(grd) <- crs(bcr)
bcr@bbox <- base_spatial@bbox
f.bcr <- as.formula(cd_10 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.06))
vari_plot_10
f.bcr <- as.formula(cd_10 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
r.m <- mask(r, base_spa)
r.m <- mask(r, base_spatial)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
tm_shape(r.m) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
r.m <- mask(r, base_spatial)
tm_shape(r.m) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
bcr@bbox
View(bcr)
proj4string(bcr) <- CRS("+init=epsg:4326")
#Bars and Clubs dataframe
bcr <- read_csv('dataset/besttime/processed_bars_clubs.csv')
bcr <- na.omit(bcr)
#Restaurants dataframe
res <- read_csv('dataset/besttime/processed_restaurants.csv')
res <- na.omit(res)
res <- res %>% rename(`12am_cd` = `12pm_cd`)
bcr <- bcr %>% select(lat,lon, `10pm_cd`,`11pm_cd`,`12am_cd`,`1am_cd`,`2am_cd`) %>% mutate(cat = "Bars and Clubs")
res <- res %>% select(lat,lon, `10pm_cd`,`11pm_cd`,`12am_cd`,`1am_cd`,`2am_cd`)%>% mutate(cat = "Restaurants")
bcr <- rbind(bcr,res)
bcr$`cd_10` <- bcr$`10pm_cd`
bcr$`cd_11` <- bcr$`11pm_cd`
bcr$`cd_12` <- bcr$`12am_cd`
bcr$`cd_1` <- bcr$`1am_cd`
bcr$`cd_2` <- bcr$`2am_cd`
coordinates(bcr) <- ~lon + lat
#Tranform to spatial dataframe and see how it looks like
plot(bcr) #notice that one point is so much further away than the rest
bcr <- bcr[-c(10,49),] #Remove that one point for better interpolation
plot(bcr) #Corrected plot without annoying point
bcr$X <- coordinates(bcr)[,1]
bcr$Y <- coordinates(bcr)[,2]
bcr <- bcr[-zerodist(bcr)[,1],]
base_spatial <- as(base_map, 'Spatial')
bcr_spatial <- st_as_sf(bcr, coords = c("lon", "lat"))
tmap_mode('plot')
tmap_options(check.and.fix = TRUE)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(bcr_spatial) + tm_dots(size = 0.5, col = "red") + # Nightlife and Restaurants locations
tm_scale_bar(width = 0.15)
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife and Late Restaurants \n in Singapore",
title.position = c('left', 'bottom'))
proj4string(bcr) <- CRS("+init=epsg:4326")
crs(base_spatial) <- crs(bcr)
crs(grd) <- crs(bcr)
bcr@bbox <- base_spatial@bbox
f.bcr <- as.formula(cd_10 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.06))
vari_plot_10
f.bcr <- as.formula(cd_10 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
r.m <- mask(r, base_spatial)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white")
tm_shape(r.m) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
base_spatial@bbox
proj4string(base_spatial) <- CRS("+init=epsg:4326")
subzones <- st_read(dsn = "dataset/basemap", layer = "MP14_SUBZONE_NO_SEA_PL")
#Central area of SG
base_map <- st_read(dsn = "dataset/basemap", layer = "MP14_SUBZONE_NO_SEA_PL")
central_area <- base_map %>% filter(PLN_AREA_N %in% c('DOWNTOWN CORE', 'BUKIT MERAH', 'SINGAPORE RIVER', 'MUSEUM', 'RIVER VALLEY', 'ORCHARD','NEWTON','ROCHOR','TANGLIN', 'KALLANG','OUTRAM')) %>% filter(!SUBZONE_N %in% c( 'CITY TERMINALS','MARITIME SQUARE','ALEXANDRA HILL','TELOK BLANGAH DRIVE','DEPOT ROAD','TELOK BLANGAH WAY','TELOK BLANGAH RISE'))
base_map <- st_transform(central_area, crs=st_crs(central_area))
#Bars and Clubs dataframe
bcr <- read_csv('dataset/besttime/processed_bars_clubs.csv')
bcr <- na.omit(bcr)
#Restaurants dataframe
res <- read_csv('dataset/besttime/processed_restaurants.csv')
res <- na.omit(res)
res <- res %>% rename(`12am_cd` = `12pm_cd`)
bcr <- bcr %>% select(lat,lon, `10pm_cd`,`11pm_cd`,`12am_cd`,`1am_cd`,`2am_cd`) %>% mutate(cat = "Bars and Clubs")
res <- res %>% select(lat,lon, `10pm_cd`,`11pm_cd`,`12am_cd`,`1am_cd`,`2am_cd`)%>% mutate(cat = "Restaurants")
bcr <- rbind(bcr,res)
bcr$`cd_10` <- bcr$`10pm_cd`
bcr$`cd_11` <- bcr$`11pm_cd`
bcr$`cd_12` <- bcr$`12am_cd`
bcr$`cd_1` <- bcr$`1am_cd`
bcr$`cd_2` <- bcr$`2am_cd`
coordinates(bcr) <- ~lon + lat
#Tranform to spatial dataframe and see how it looks like
plot(bcr) #notice that one point is so much further away than the rest
bcr <- bcr[-c(10,49),] #Remove that one point for better interpolation
plot(bcr) #Corrected plot without annoying point
bcr$X <- coordinates(bcr)[,1]
bcr$Y <- coordinates(bcr)[,2]
bcr <- bcr[-zerodist(bcr)[,1],]
base_spatial <- as(base_map, 'Spatial')
bcr_spatial <- st_as_sf(bcr, coords = c("lon", "lat"))
tmap_mode('plot')
tmap_options(check.and.fix = TRUE)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(bcr_spatial) + tm_dots(size = 0.5, col = "red") + # Nightlife and Restaurants locations
tm_scale_bar(width = 0.15)
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife and Late Restaurants \n in Singapore",
title.position = c('left', 'bottom'))
#Bars and Clubs dataframe
bcr <- read_csv('dataset/besttime/processed_bars_clubs.csv')
bcr <- na.omit(bcr)
#Restaurants dataframe
res <- read_csv('dataset/besttime/processed_restaurants.csv')
res <- na.omit(res)
res <- res %>% rename(`12am_cd` = `12pm_cd`)
bcr <- bcr %>% select(lat,lon, `10pm_cd`,`11pm_cd`,`12am_cd`,`1am_cd`,`2am_cd`) %>% mutate(cat = "Bars and Clubs")
res <- res %>% select(lat,lon, `10pm_cd`,`11pm_cd`,`12am_cd`,`1am_cd`,`2am_cd`)%>% mutate(cat = "Restaurants")
bcr <- rbind(bcr,res)
bcr$`cd_10` <- bcr$`10pm_cd`
bcr$`cd_11` <- bcr$`11pm_cd`
bcr$`cd_12` <- bcr$`12am_cd`
bcr$`cd_1` <- bcr$`1am_cd`
bcr$`cd_2` <- bcr$`2am_cd`
coordinates(bcr) <- ~lon + lat
#Tranform to spatial dataframe and see how it looks like
plot(bcr) #notice that one point is so much further away than the rest
bcr <- bcr[-c(10,49),] #Remove that one point for better interpolation
plot(bcr) #Corrected plot without annoying point
bcr$X <- coordinates(bcr)[,1]
bcr$Y <- coordinates(bcr)[,2]
bcr <- bcr[-zerodist(bcr)[,1],]
base_spatial <- as(base_map, 'Spatial')
bcr_spatial <- st_as_sf(bcr, coords = c("lon", "lat"))
tmap_mode('plot')
tmap_options(check.and.fix = TRUE)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(bcr_spatial) + tm_dots(size = 0.5, col = "red") + # Nightlife and Restaurants locations
tm_scale_bar(width = 0.15)
tm_layout(legend.format = list(digits = 0),
legend.position = c("left", "bottom"),
legend.text.size = 0.25,
legend.title.size = 0.5,
title="Nightlife and Late Restaurants \n in Singapore",
title.position = c('left', 'bottom'))
#Making the raster grid
grd              <- as.data.frame(spsample(bcr, "regular", n=50000))
names(grd)       <- c("X", "Y")
coordinates(grd) <- c("X", "Y")
gridded(grd)     <- TRUE
fullgrid(grd)    <- TRUE
crs(grd) <- crs(bcr)
f.bcr <- as.formula(cd_10 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.06))
vari_plot_10
f.bcr <- as.formula(cd_10 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
r.m <- mask(r, base_spatial)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
r.m <- mask(r, base_map)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r.n) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r.m) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
vari_plot_10
grd              <- as.data.frame(spsample(base_spatial, "regular", n=50000))
#Making the raster grid
grd              <- as.data.frame(spsample(base_spatial, "regular", n=50000))
names(grd)       <- c("X", "Y")
coordinates(grd) <- c("X", "Y")
gridded(grd)     <- TRUE
fullgrid(grd)    <- TRUE
crs(grd) <- crs(bcr)
f.bcr <- as.formula(cd_10 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.06))
vari_plot_10
f.bcr <- as.formula(cd_10 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
r.m <- mask(r, base_map)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
vari_plot_10
tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(bcr_spatial) + tm_dots(size = 0.5, col = 'cat', palette = c('blue','green2')) + # Nightlife and Restaurants locations
tm_scale_bar(width = 0.15)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
#Making the raster grid
grd              <- as.data.frame(spsample(bcr, "regular", n=50000))
names(grd)       <- c("X", "Y")
coordinates(grd) <- c("X", "Y")
gridded(grd)     <- TRUE
fullgrid(grd)    <- TRUE
crs(grd) <- crs(bcr)
f.bcr <- as.formula(cd_10 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.06))
vari_plot_10
f.bcr <- as.formula(cd_10 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
tmap_mode('view')
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
tmap_mode('plot')
f.bcr <- as.formula(cd_10 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.06))
vari_plot_10
f.bcr <- as.formula(cd_10 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
vari_plot_10
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.005)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.06))
vari_plot_10
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0001)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.06))
vari_plot_10
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.06))
vari_plot_10
# The following plot allows us to assess the fit
vari_plot_10 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.05))
vari_plot_10
f.bcr <- as.formula(cd_11 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=600))
# The following plot allows us to assess the fit
vari_plot_11 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.05))
vari_plot_11
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=650))
# The following plot allows us to assess the fit
vari_plot_11 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.05))
vari_plot_11
f.bcr <- as.formula(cd_10 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
i_11 <- tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
i_11
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
i_11 <- tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 11pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
i_11
i_10
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
i_10 <- tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 10pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
i_10
i_11
i_10
i_11
f.bcr <- as.formula(cd_11 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
i_11 <- tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 11pm", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
i_10
i_11
f.bcr <- as.formula(cd_12 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=650))
# The following plot allows us to assess the fit
vari_plot_12 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.05))
vari_plot_12
f.bcr <- as.formula(cd_12 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
i_12 <- tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 12am", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
f.bcr <- as.formula(cd_1 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=650))
# The following plot allows us to assess the fit
vari_plot_1 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.05))
vari_plot_1
f.bcr <- as.formula(cd_1 ~ X + Y)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
dat.krg <- krige(f.bcr, bcr, grd, dat.fit.bcr)
r <- raster(dat.krg)
#tm_shape(base_map) + tm_borders(col='black') + tm_fill(col = "white") +
i_1 <- tm_shape(r) +
tm_raster(n=13, stretch.palette=FALSE,
title="Interpolation of Crowd Density at 1am", palette = 'Reds', style = 'fixed',breaks = c(-10,0,10,20,30,40,50,60,70,80,90,100,110,120),alpha = 0.7) +
tm_shape(bcr) + tm_dots(size=0.1, col = 'cat', palette = c('blue','green2')) +
tm_legend(legend.outside=TRUE)
f.bcr <- as.formula(cd_2 ~ lon + lat)
var.smpl.bcr <- variogram(f.bcr, bcr, cloud = FALSE, cutoff=1, width=0.0025)
dat.fit.bcr  <- fit.variogram(var.smpl.bcr, fit.ranges = F, fit.sills = F,
vgm(psill=400, model="Wav", range=0.025, nugget=650))
# The following plot allows us to assess the fit
vari_plot_2 <- plot(var.smpl.bcr, dat.fit.bcr, xlim = c(0, 0.05))
vari_plot_2
